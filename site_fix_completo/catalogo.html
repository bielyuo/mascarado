<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <title>Cat√°logo ‚Äî M√°scara Secreta</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="img/logo.png">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    :root { --red: #c0152a; --red-glow: #ff2244; --dark: #080c10; --navy: #0d1520; --silver: #a8b8cc; --white: #eef2f7; }
    html { scroll-behavior: smooth; }
    body { background: var(--dark); font-family: 'Rajdhani', sans-serif; color: var(--white); padding-top: 80px; }
    ::-webkit-scrollbar { width: 6px; } ::-webkit-scrollbar-track { background: var(--dark); } ::-webkit-scrollbar-thumb { background: var(--red); border-radius: 3px; }

    /* NAV ‚Äî id√™ntico ao index */
    header { position: fixed; top: 0; left: 0; right: 0; z-index: 100; background: linear-gradient(180deg,rgba(8,12,16,.98),rgba(8,12,16,.85)); border-bottom: 1px solid rgba(192,21,42,.35); backdrop-filter: blur(12px); }
    nav { max-width: 1200px; margin: 0 auto; padding: 0 2rem; height: 70px; display: flex; align-items: center; gap: 1.5rem; }
    .nav-home { display: flex; align-items: center; justify-content: center; width: 42px; height: 42px; border-radius: 8px; border: 1px solid rgba(192,21,42,.5); color: var(--silver); text-decoration: none; transition: all .2s; background: rgba(192,21,42,.08); flex-shrink: 0; }
    .nav-home:hover { background: rgba(192,21,42,.25); border-color: var(--red-glow); color: var(--white); }
    .nav-home svg { width: 20px; height: 20px; }
    .nav-logo { display: flex; align-items: center; gap: .75rem; text-decoration: none; }
    .nav-logo img { width: 40px; height: 40px; object-fit: contain; filter: drop-shadow(0 0 8px rgba(255,34,68,.5)); }
    .nav-logo span { font-family: 'Orbitron',sans-serif; font-size: 1rem; font-weight: 900; letter-spacing: .1em; text-transform: uppercase; background: linear-gradient(90deg,#fff,var(--silver)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .nav-links { display: flex; align-items: center; gap: .25rem; list-style: none; }
    .nav-links a { font-family: 'Rajdhani',sans-serif; font-weight: 600; font-size: .88rem; letter-spacing: .1em; text-transform: uppercase; color: var(--silver); text-decoration: none; padding: .5rem .9rem; border-radius: 6px; transition: all .2s; }
    .nav-links a:hover { color: var(--white); background: rgba(192,21,42,.2); }
    .nav-links a.active { color: var(--white); }

    /* SEARCH NAV */
    .search-wrap { position: relative; margin-left: auto; }
    .search-input { width: 36px; height: 36px; padding: 0 0 0 36px; background: rgba(255,255,255,.06); border: 1px solid rgba(168,184,204,.15); border-radius: 20px; color: var(--white); font-family: 'Rajdhani',sans-serif; font-size: .9rem; outline: none; cursor: pointer; transition: all .35s; white-space: nowrap; overflow: hidden; }
    .search-input:focus, .search-input.open { width: 220px; padding: 0 1rem 0 36px; border-color: rgba(192,21,42,.5); cursor: text; background: rgba(13,21,32,.9); }
    .search-icon { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: var(--silver); pointer-events: none; font-size: .95rem; }
    .search-dropdown { display: none; position: absolute; top: calc(100% + 8px); right: 0; width: 300px; background: var(--navy); border: 1px solid rgba(192,21,42,.35); border-radius: 10px; z-index: 300; overflow: hidden; }
    .search-dropdown.show { display: block; }

    /* HERO BUSCA */
    .catalog-hero { max-width: 1200px; margin: 0 auto; padding: 3rem 2rem 1.5rem; }
    .section-title { font-family: 'Orbitron',sans-serif; font-size: 1.8rem; font-weight: 900; letter-spacing: .15em; text-transform: uppercase; margin-bottom: .5rem; }
    .section-line { width: 60px; height: 3px; background: var(--red); margin-bottom: 1.75rem; box-shadow: 0 0 10px rgba(255,34,68,.5); }

    /* BARRA DE BUSCA INLINE */
    .cat-search-bar { display: flex; align-items: center; gap: .85rem; margin-bottom: 1.5rem; }
    .cat-search-wrap { position: relative; flex: 1; max-width: 480px; }
    .cat-search-input {
      width: 100%; padding: .65rem 1rem .65rem 2.5rem;
      background: rgba(255,255,255,.06); border: 1px solid rgba(168,184,204,.15);
      border-radius: 8px; color: var(--white);
      font-family: 'Rajdhani',sans-serif; font-size: .95rem;
      outline: none; transition: border-color .25s, background .25s;
    }
    .cat-search-input:focus { border-color: rgba(192,21,42,.5); background: rgba(13,21,32,.9); }
    .cat-search-input::placeholder { color: rgba(168,184,204,.35); }
    .cat-search-ico { position: absolute; left: .75rem; top: 50%; transform: translateY(-50%); color: var(--silver); font-size: .9rem; pointer-events: none; }
    .cat-clear { position: absolute; right: .65rem; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--silver); cursor: pointer; font-size: .9rem; display: none; }
    .cat-clear.show { display: block; }
    .cat-count { font-size: .82rem; color: var(--silver); letter-spacing: .06em; font-weight: 600; margin-left: auto; }
    .cat-count b { color: var(--red); }

    /* GRID ‚Äî id√™ntico ao index series-cards */
    .catalog-grid {
      max-width: 1200px; margin: 0 auto; padding: 0 2rem 5rem;
      display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem;
    }

    /* CARDS ‚Äî id√™nticos ao index */
    .serie-card {
      background: var(--navy); border: 1px solid rgba(192,21,42,.2);
      border-radius: 12px; overflow: hidden;
      text-decoration: none; color: inherit;
      transition: 0.2s; display: block;
      animation: fadeIn .3s ease both;
    }
    .serie-card:hover { border-color: rgba(255,34,68,.45); transform: translateY(-4px); box-shadow: 0 12px 35px rgba(0,0,0,.4), 0 0 20px rgba(192,21,42,.1); }
    @keyframes fadeIn { from { opacity:0; transform:translateY(12px); } to { opacity:1; transform:translateY(0); } }
    .card-banner { width: 100%; height: 160px; object-fit: cover; display: block; }
    .card-banner-ph { width: 100%; height: 160px; display: flex; align-items: center; justify-content: center; font-size: 3rem; background: rgba(13,21,32,.8); }
    .card-body { padding: 1.2rem; }
    .card-name { font-family: 'Orbitron',sans-serif; font-weight: 900; font-size: .9rem; letter-spacing: .05em; margin-bottom: .5rem; }
    .card-desc { font-size: .78rem; color: var(--silver); line-height: 1.5; margin-bottom: .6rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    .card-ep-count { font-size: .75rem; color: var(--red); font-weight: 700; letter-spacing: .08em; }

    /* EMPTY */
    .empty-state { grid-column: 1/-1; text-align: center; padding: 5rem 2rem; }
    .empty-icon { font-size: 3.5rem; opacity: .4; margin-bottom: 1rem; }
    .empty-title { font-family: 'Orbitron',sans-serif; font-size: 1rem; letter-spacing: .2em; text-transform: uppercase; color: rgba(168,184,204,.3); }

    footer { text-align: center; padding: 2.5rem; color: rgba(168,184,204,.4); font-size: .85rem; border-top: 1px solid rgba(192,21,42,.15); }

    @media (max-width: 900px) { .catalog-grid { grid-template-columns: repeat(2,1fr); } }
    @media (max-width: 600px) { .catalog-grid { grid-template-columns: 1fr; } .nav-links { display:none; } }
  </style>
</head>
<body>

<header>
  <nav>
    <a href="index.html" class="nav-home">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9.5L12 3l9 6.5V20a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V9.5z"/><polyline points="9 21 9 12 15 12 15 21"/></svg>
    </a>
    <a href="index.html" class="nav-logo">
      <img src="img/logo.png" alt="">
      <span>M√°scara Secreta</span>
    </a>
    <ul class="nav-links">
      <li><a href="index.html">In√≠cio</a></li>
      <li><a href="catalogo.html" class="active">Cat√°logo</a></li>
    </ul>
    <div class="search-wrap">
      <input class="search-input" id="nav-search" type="text" placeholder="Buscar s√©rie..." autocomplete="off"
        oninput="onNavSearch(this.value)"
        onfocus="this.classList.add('open')"
        onblur="setTimeout(function(){document.getElementById('nav-dd').classList.remove('show');},200)">
      <span class="search-icon">üîç</span>
      <div class="search-dropdown" id="nav-dd"></div>
    </div>
  </nav>
</header>

<div class="catalog-hero">
  <h2 class="section-title">Cat√°logo</h2>
  <div class="section-line"></div>
  <div class="cat-search-bar">
    <div class="cat-search-wrap">
      <span class="cat-search-ico">üîç</span>
      <input class="cat-search-input" id="cat-input" type="text"
        placeholder="Buscar s√©rie..." autocomplete="off"
        oninput="onSearch(this.value)"
        autofocus>
      <button class="cat-clear" id="cat-clear" onclick="clearSearch()">‚úï</button>
    </div>
    <div class="cat-count" id="cat-count"></div>
  </div>
</div>

<div class="catalog-grid" id="catalog-grid"></div>

<footer><p>¬© 2025 M√°scara Secreta ¬∑ Todos os direitos reservados</p></footer>

<script>
  var series = JSON.parse(localStorage.getItem('ms_series') || '[]');
  var videos = JSON.parse(localStorage.getItem('ms_videos') || '[]');
  var query  = '';

  function epCount(s) {
    return videos.filter(function(v){ return v.ep && v.ep.indexOf(s.prefix + ' ') === 0; }).length;
  }

  function onSearch(q) {
    query = q.trim();
    document.getElementById('cat-clear').classList.toggle('show', query.length > 0);
    render();
  }

  function clearSearch() {
    document.getElementById('cat-input').value = '';
    document.getElementById('cat-clear').classList.remove('show');
    query = '';
    render();
  }

  function render() {
    var visible = series.filter(function(s){ return !s.hidden; });
    var list = !query ? visible : visible.filter(function(s){
      return s.name.toLowerCase().indexOf(query.toLowerCase()) > -1;
    });

    // Count
    var cnt = document.getElementById('cat-count');
    if (query) {
      cnt.innerHTML = list.length
        ? '<b>' + list.length + '</b> resultado' + (list.length!==1?'s':'') + ' para "' + query + '"'
        : '0 resultados para "' + query + '"';
    } else {
      cnt.innerHTML = '<b>' + list.length + '</b> s√©rie' + (list.length!==1?'s':'');
    }

    var grid = document.getElementById('catalog-grid');
    if (!list.length) {
      grid.innerHTML = '<div class="empty-state"><div class="empty-icon">üé≠</div><div class="empty-title">Nenhuma s√©rie encontrada</div></div>';
      return;
    }

    grid.innerHTML = list.map(function(s, idx) {
      var i    = series.indexOf(s);
      var eps  = epCount(s);
      var img  = s.banner || s.defaultImg || '';
      var delay = (idx % 12) * 35;
      return '<a class="serie-card" href="serie.html?id=' + i + '" style="animation-delay:' + delay + 'ms">'
        + (img
          ? '<img class="card-banner" src="' + img + '" onerror="this.outerHTML=\'<div class=\\\'card-banner-ph\\\'>üé≠</div>\'">'
          : '<div class="card-banner-ph">üé≠</div>')
        + '<div class="card-body">'
        +   '<div class="card-name">' + s.name + '</div>'
        +   (s.desc ? '<div class="card-desc">' + s.desc + '</div>' : '')
        +   '<div class="card-ep-count">' + eps + ' epis√≥dio' + (eps!==1?'s':'') + '</div>'
        + '</div></a>';
    }).join('');
  }

  // Nav search dropdown
  function onNavSearch(q) {
    var dd = document.getElementById('nav-dd');
    q = q.trim().toLowerCase();
    if (!q) { dd.classList.remove('show'); return; }
    var res = series.filter(function(s){ return !s.hidden && s.name.toLowerCase().indexOf(q) > -1; });
    dd.classList.add('show');
    dd.innerHTML = res.length
      ? res.map(function(s){ return '<a style="display:block;padding:10px;text-decoration:none;color:#fff;border-bottom:1px solid rgba(255,255,255,.06)" href="serie.html?id='+series.indexOf(s)+'">'+s.name+'</a>'; }).join('')
      : '<div style="padding:10px;color:var(--silver);font-size:.85rem">Nenhuma s√©rie encontrada</div>';
  }

  render();

  // Pressionar / foca busca
  window.addEventListener('keydown', function(e){
    if (e.key === '/' && document.activeElement !== document.getElementById('cat-input')) {
      e.preventDefault(); document.getElementById('cat-input').focus();
    }
    if (e.ctrlKey && e.altKey && (e.key==='a'||e.key==='A')){ e.preventDefault(); window.location.href='admin.html'; }
  }, true);
</script>
</body>
</html>
